<?php

/**
 * @file
 * Install file for the Simple Content Type module
 */
/**
 * Implements hook_uninstall().
 */
function osa_uninstall() {
	// gather all the content created while the module was enabled
	$result = db_select('node', 'n')
		->fields('n', array('nid'))
		->condition("n.type", 'osa')
		->execute();
	
	$nids = array();
	foreach ($result as $row) {
		$nids[] = $row->nid;
	}
	
	// delete all the nodes at once
	node_delete_multiple($nids);
	// delete our content type
	node_type_delete('osa');
	// purge all field information
	field_purge_batch(1000);
	
	// get rid of any tables we created
	$sql = 'DROP TABLE IF EXISTS osa_data, osa_user';
	$result = db_query($sql);
}
/**
 * Implements hook_schema().
 */
function osa_schema() {
	// table schema to track example data
	$schema['osa_data'] = array(
		'description' => 'Stores information for our example content type.',
		'fields' => array(
			'nid' => array(
				'description' => 'The {node}.nid of the node being created.',
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
			),
			'uid' => array(
				'description' => 'The {user}.uid of the user this node belongs to.',
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
			),
			'osa_textfield' => array(
				'description' => 'The value entered into the text field.',
				'type' => 'varchar',
				'length' => 255,
				'not null' => TRUE,
			),
			'osa_textarea' => array(
				'description' => 'The value for our textarea without formats.',
				'type' => 'text',
				'size' => 'big',
				'not null' => TRUE,
			),
			'osa_text' => array(
				'description' => 'The value for our textarea with formats.',
				'type' => 'text',
				'size' => 'big',
				'not null' => TRUE,
			),
			'osa_format' => array(
				'description' => 'The format for our textarea with formats.',
				'type' => 'varchar',
				'length' => 255,
				'not null' => TRUE,
			),
			
		),
		'index' => array('nid'),
		'primary key' => array('nid'),
		'unique keys' => array(
			'nid' => array('nid'),
		),
	);
  
  $schema['osa_user'] = array(
		'description' => 'Stores information for our example content type.',
		'fields' => array(
			'nid' => array(
				'description' => 'The {node}.nid of the node being created.',
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
			),
			'uid' => array(
				'description' => 'The {user}.uid of the user this node belongs to.',
				'type' => 'int',
				'unsigned' => TRUE,
				'not null' => TRUE,
			),
			'osa_textfield' => array(
				'description' => 'The value entered into the text field.',
				'type' => 'varchar',
				'length' => 255,
				'not null' => TRUE,
			),
			'osa_textarea' => array(
				'description' => 'The value for our textarea without formats.',
				'type' => 'text',
				'size' => 'big',
				'not null' => TRUE,
			),
			'osa_text' => array(
				'description' => 'The value for our textarea with formats.',
				'type' => 'text',
				'size' => 'big',
				'not null' => TRUE,
			),
			'osa_format' => array(
				'description' => 'The format for our textarea with formats.',
				'type' => 'varchar',
				'length' => 255,
				'not null' => TRUE,
			),
			
		),
		'index' => array('nid'),
		'primary key' => array('nid'),
		'unique keys' => array(
			'nid' => array('nid'),
		),
	);
	
	return $schema;
}